###############################################
###
### This file is generated by txpp. Do not edit.
###
### Input file : /data/Mina/PenningIoniEnFun/R/PenningDischargeSq.pre
### Output file: /data/Mina/PenningIoniEnFun/R/PenningDischargeSq.in
### Translation: Mon, 21 Feb 2022 09:17:09
###
###############################################

nsteps = 5000000
dumpPeriodicity = 5000
dt = 5e-12
dimension = 2
floattype = double
verbosity = 127
copyHistoryAtEachDump = 0
useGridBndryRestore = True
constructUniverse = False

<Grid globalGrid>
  verbosity = 127
  numCells = [250  250  12]
  lengths = [0.03 0.03 1.0]
  startPositions = [0.0 0.0 0.0]
  maxCellXings = 1
</Grid>

<DomainDecomp decomp>
  periodicDirs = [2]
</DomainDecomp>

<RankDecomp rd>
  verbosity = 127
  maxNumDevices = 0
</RankDecomp>

<MultiField esMultiField>

  <Field BackgroundB>
    numComponents = 3
    overlap = [1 1]
    offset = none
    labels = [BackgroundB_x   BackgroundB_y   BackgroundB_z]

    <InitialCondition initBackgroundB>
      kind = varset
      lowerBounds = [0  0]
      upperBounds = [251  251]
      components = [0 1 2]

      <STFunc component0>
        kind = expression
        expression = 0.0
      </STFunc>

      <STFunc component1>
        kind = expression
        expression = 0.0
      </STFunc>

      <STFunc component2>
        kind = expression
        expression = 0.015
      </STFunc>

    </InitialCondition>

    dumpSteps = [0]
  </Field>

  <Field E>
    numComponents = 3
    offset = edge
    kind = regular
    overlap = [1 1]
    labels = [E_x   E_y   E_z]
  </Field>

  <Field nodalE>
    numComponents = 3
    offset = none
    kind = regular
    overlap = [1 2]
    labels = [nodalE_x   nodalE_y   nodalE_z]
  </Field>

  <Field nodalB>
    numComponents = 3
    offset = none
    kind = regular
    overlap = [1 2]
    labels = [nodalB_x   nodalB_y   nodalB_z]
  </Field>

  <Field Phi>
    numComponents = 1
    offset = none
    kind = regular
    overlap = [1 2]
    labels = [Phi]
  </Field>

  <Field ChargeDensity>
    numComponents = 1
    offset = none
    kind = depField
    overlap = [1 2]
    labels = [ChargeDensity]
  </Field>

  <FieldUpdater BackgroundBaddingUpdater>
    kind = fieldBinOpUpdater
    binOp = add
    lowerBounds = [0  0  0]
    upperBounds = [251  251  13]
    aCoeff = 1.0
    bCoeff = 1.0
    readFields = [BackgroundB nodalB]
    writeFields = [nodalB]
  </FieldUpdater>

  <FieldUpdater gradPhi>
    kind = gradVecUpdater
    factor = -1.0
    lowerBounds = [0  0  0]
    upperBounds = [250   250   12]
    readFields = [Phi]
    writeFields = [E]
  </FieldUpdater>

  <FieldUpdater edgeToNode>
    kind = edgeToNodeVec
    lowerBounds = [0  0  0]
    upperBounds = [251  251  13]
    readFields = [E]
    writeFields = [nodalE]
  </FieldUpdater>

  <FieldUpdater copyPerimlowerX>
    kind = unaryFieldOpUpdater
    minDim = 1
    lowerBounds = [0  0  0]
    upperBounds = [1  251  13]
    operation = set
    bumpReadIter = [0  0  0]
    readFields = [E]
    component = 0
    writeFields = [nodalE]

    <STFunc copyFunc>
      kind = constantFunc
      amplitude = 1.
    </STFunc>

  </FieldUpdater>

  <FieldUpdater copyPerimupperX>
    kind = unaryFieldOpUpdater
    minDim = 1
    lowerBounds = [250  0  0]
    upperBounds = [251  251  13]
    operation = set
    bumpReadIter = [-1  0  0]
    readFields = [E]
    component = 0
    writeFields = [nodalE]

    <STFunc copyFunc>
      kind = constantFunc
      amplitude = 1.
    </STFunc>

  </FieldUpdater>

  <FieldUpdater copyPerimlowerY>
    kind = unaryFieldOpUpdater
    minDim = 2
    lowerBounds = [0  0  0]
    upperBounds = [251  1  13]
    operation = set
    bumpReadIter = [0  0  0]
    readFields = [E]
    component = 1
    writeFields = [nodalE]

    <STFunc copyFunc>
      kind = constantFunc
      amplitude = 1.
    </STFunc>

  </FieldUpdater>

  <FieldUpdater copyPerimupperY>
    kind = unaryFieldOpUpdater
    minDim = 2
    lowerBounds = [0  250  0]
    upperBounds = [251  251  13]
    operation = set
    bumpReadIter = [0  -1  0]
    readFields = [E]
    component = 1
    writeFields = [nodalE]

    <STFunc copyFunc>
      kind = constantFunc
      amplitude = 1.
    </STFunc>

  </FieldUpdater>

  <InitialUpdateStep BackgroundBaddingUpdaterInitStep>
    alsoAfterRestore = False
    updaters = [BackgroundBaddingUpdater]
    messageFields = [nodalB]
  </InitialUpdateStep>

  <InitialUpdateStep esSolveInitialUpdateStep>
    alsoAfterRestore = False
    updaters = [esSolve]
    messageFields = [Phi]
  </InitialUpdateStep>

  <InitialUpdateStep edgeToNodeInitStep>
    alsoAfterRestore = False
    updaters = [edgeToNode]
    messageFields = [nodalE]
  </InitialUpdateStep>

  <InitialUpdateStep gradPhiInitStep>
    alsoAfterRestore = False
    updaters = [gradPhi]
    messageFields = [E]
  </InitialUpdateStep>

  <UpdateStep esSolveStep>
    toDtFrac = 1.0
    updaters = [esSolve]
    messageFields = [Phi]
  </UpdateStep>

  <UpdateStep gradPhiStep>
    toDtFrac = 1.0
    updaters = [gradPhi]
    messageFields = [E]
  </UpdateStep>

  <UpdateStep edgeToNodeStep>
    toDtFrac = 1.0
    updaters = [edgeToNode]
    messageFields = [nodalE]
  </UpdateStep>

  <UpdateStep copyPerimlowerXStep>
    toDtFrac = 1.0
    updaters = [copyPerimlowerX]
    messageFields = [nodalE]
  </UpdateStep>

  <UpdateStep copyPerimupperXStep>
    toDtFrac = 1.0
    updaters = [copyPerimupperX]
    messageFields = [nodalE]
  </UpdateStep>

  <UpdateStep copyPerimlowerYStep>
    toDtFrac = 1.0
    updaters = [copyPerimlowerY]
    messageFields = [nodalE]
  </UpdateStep>

  <UpdateStep copyPerimupperYStep>
    toDtFrac = 1.0
    updaters = [copyPerimupperY]
    messageFields = [nodalE]
  </UpdateStep>

  <FieldUpdater esSolve>
    kind = linearSolveUpdater
    lowerBounds = [0  0]
    upperBounds = [251  251]
    readFields = [ChargeDensity]
    readComponents = [0]
    writeFields = [Phi]
    writeComponents = [0]
    writeEquationToFile = 0

    <MatrixFiller interiorFiller>
      kind = stFuncStencilFiller
      verbosity = 127
      minDim = 1
      lowerBounds = [1  1  0]
      upperBounds = [250   250   12]
      component = 0

      <STFunc coeff>
        kind = expression
        expression = -8.854187817591624e-12
      </STFunc>

      <STFuncStencilElement phi_dxp>
        value = -69444444.44444445
        minDim = 1
        cellOffset = [0 0 0]
        functionOffset = [0.5 0. 0.]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_dxm>
        value = -69444444.44444445
        minDim = 1
        cellOffset = [0 0 0]
        functionOffset = [-0.5 0. 0.]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_dyp>
        value = -69444444.44444445
        minDim = 2
        cellOffset = [0 0 0]
        functionOffset = [0. 0.5 0.]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_dym>
        value = -69444444.44444445
        minDim = 2
        cellOffset = [0 0 0]
        functionOffset = [0. -0.5 0.]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_dzp>
        value = -144.0
        minDim = 3
        cellOffset = [0 0 0]
        functionOffset = [0. 0. 0.5]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_dzm>
        value = -144.0
        minDim = 3
        cellOffset = [0 0 0]
        functionOffset = [0. 0. -0.5]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_npx>
        value = 69444444.44444445
        minDim = 1
        cellOffset = [1 0 0]
        functionOffset = [0.5 0. 0.]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_nmx>
        value = 69444444.44444445
        minDim = 1
        cellOffset = [-1 0 0]
        functionOffset = [-0.5 0. 0.]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_npy>
        value = 69444444.44444445
        minDim = 2
        cellOffset = [0 1 0]
        functionOffset = [0. 0.5 0.]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_nmy>
        value = 69444444.44444445
        minDim = 2
        cellOffset = [0 -1 0]
        functionOffset = [0. -0.5 0.]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_npz>
        value = 144.0
        minDim = 3
        cellOffset = [0 0 1]
        functionOffset = [0. 0. 0.5]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

      <STFuncStencilElement phi_nmz>
        value = 144.0
        minDim = 3
        cellOffset = [0 0 -1]
        functionOffset = [0. 0. -0.5]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </STFuncStencilElement>

    </MatrixFiller>

    <VectorWriter interiorWriter>
      kind = fieldVectorWriter
      verbosity = 127
      minDim = 1
      readField = ChargeDensity
      readComponent = 0
      lowerBounds = [1  1  0]
      upperBounds = [250   250   12]
      component = 0
    </VectorWriter>

    <VectorReader phiReader>
      kind = fieldVectorReader
      minDim = 0
      writeField = Phi
      writeComponent = 0
      lowerBounds = [0  0]
      upperBounds = [251  251]
      componentBounds = [0 1]
    </VectorReader>

    <MatrixFiller dirichlet1Filler>
      kind = stencilFiller
      verbosity = 127
      minDim = 2
      lowerBounds = [0  0  0]
      upperBounds = [251  1  12]
      component = 0

      <StencilElement ident>
        value = 0.0024594966159976733
        minDim = 0
        cellOffset = [0  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter dirichlet1Writer>
      kind = stFuncVectorWriter
      verbosity = 127
      minDim = 2
      lowerBounds = [0  0  0]
      upperBounds = [251  1  12]
      component = 0

      <STFunc function>
        kind = expression
        expression = 0.0
      </STFunc>

      scaling = 0.0024594966159976733
    </VectorWriter>

    <MatrixFiller dirichlet2Filler>
      kind = stencilFiller
      verbosity = 127
      minDim = 2
      lowerBounds = [0  250  0]
      upperBounds = [251  251  12]
      component = 0

      <StencilElement ident>
        value = 0.0024594966159976733
        minDim = 0
        cellOffset = [0  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter dirichlet2Writer>
      kind = stFuncVectorWriter
      verbosity = 127
      minDim = 2
      lowerBounds = [0  250  0]
      upperBounds = [251  251  12]
      component = 0

      <STFunc function>
        kind = expression
        expression = 0.0
      </STFunc>

      scaling = 0.0024594966159976733
    </VectorWriter>

    <MatrixFiller dirichlet0Filler>
      kind = stencilFiller
      verbosity = 127
      minDim = 1
      lowerBounds = [0  1  0]
      upperBounds = [1  250  12]
      component = 0

      <StencilElement ident>
        value = 0.0024594966159976733
        minDim = 0
        cellOffset = [0  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter dirichlet0Writer>
      kind = stFuncVectorWriter
      verbosity = 127
      minDim = 1
      lowerBounds = [0  1  0]
      upperBounds = [1  250  12]
      component = 0

      <STFunc function>
        kind = expression
        expression = 0.0
      </STFunc>

      scaling = 0.0024594966159976733
    </VectorWriter>

    <MatrixFiller dirichlet3Filler>
      kind = stencilFiller
      verbosity = 127
      minDim = 1
      lowerBounds = [250  1  0]
      upperBounds = [251  250  12]
      component = 0

      <StencilElement ident>
        value = 0.0024594966159976733
        minDim = 0
        cellOffset = [0  0  0]
        rowFieldIndex = 0
        columnFieldIndex = 0
      </StencilElement>

    </MatrixFiller>

    <VectorWriter dirichlet3Writer>
      kind = stFuncVectorWriter
      verbosity = 127
      minDim = 1
      lowerBounds = [250  1  0]
      upperBounds = [251  250  12]
      component = 0

      <STFunc function>
        kind = expression
        expression = 0.0
      </STFunc>

      scaling = 0.0024594966159976733
    </VectorWriter>

    <LinearSolver linearSolver>
      kind = iterativeSolver
      verbosity = 127
      output = last
      maxIterations = 200
      tolerance = 1e-08
      convergenceMetric = r0

      <BaseSolver myBS>
        kind = gmres
        kspace = 30
        orthog = classic
      </BaseSolver>

      <Preconditioner precond>
        kind = multigrid
        mgOutput = 0
        mgDefaults = DD
        maxLevels = 10
        smootherType = GaussSeidel
        smootherSweeps = 3
        smootherPrePost = both
        coarseType = Jacobi
        dampingFactor = 1.333
        threshold = 0.0
        increaseDecrease = increasing
      </Preconditioner>

    </LinearSolver>

  </FieldUpdater>

  updateStepOrder = [esSolveStep gradPhiStep edgeToNodeStep copyPerimlowerXStep copyPerimupperXStep copyPerimlowerYStep copyPerimupperYStep]
</MultiField>

<ScalarDepositor ChargeDensityDep>
  kind = areaWeighting
  depField = esMultiField.ChargeDensity
</ScalarDepositor>

<Species electrons>
  kind = nonRelBoris
  charge = -1.6021766208e-19
  mass = 9.10938215e-31
  maxcellxing = 1
  nominalDensity = 0.0
  numPtclsInMacro = 17023500.0
  fields = [esMultiField.nodalE esMultiField.nodalB]
  chargeDeps = [ChargeDensityDep]

  <ParticleSource particleLoader0>
    kind = xvLoaderEmitter
    load = True
    applyTimes = [0.0 3.40282e+38]
    loadAfterInit = 1
    loadOnShift = 1

    <STFunc relMacroDenFunc>
      kind = expression
      expression = 0.00045
    </STFunc>

    <PositionGenerator posGen>
      kind = gridPosGen
      macroPerDir = [1  1  1]

      <Slab loadSlab>
        lowerBounds = [0.012  0.012  0.0]
        upperBounds = [0.018  0.018  0.0]
      </Slab>

      emitDirSign = 1
    </PositionGenerator>

    <VelocityGenerator velGen>
      kind = funcVelGen
      emitVelocityIsLocal = True

      <STFunc component0>
        kind = expression
        expression = 0.0
      </STFunc>

      <STFunc component1>
        kind = expression
        expression = 0.0
      </STFunc>

      <STFunc component2>
        kind = expression
        expression = 805000.0
      </STFunc>

    </VelocityGenerator>

  </ParticleSource>

  <ParticleSink lower0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [-1   -1   -1]
    upperBounds = [0   251   13]
  </ParticleSink>

  <ParticleSink upper0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [250   -1   -1]
    upperBounds = [251   251   13]
  </ParticleSink>

  <ParticleSink lower1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   -1   -1]
    upperBounds = [250   0   13]
  </ParticleSink>

  <ParticleSink upper1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   250   -1]
    upperBounds = [250   251   13]
  </ParticleSink>

</Species>

<Species Ions>
  kind = nonRelBoris
  charge = 1.6021766208e-19
  mass = 6.6335035132167e-26
  ionizationEnergy = 27.62967
  maxcellxing = 1
  nominalDensity = 0.0
  numPtclsInMacro = 17023500.0
  fields = [esMultiField.nodalE esMultiField.nodalB]
  chargeDeps = [ChargeDensityDep]

  <ParticleSink lower0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [-1   -1   -1]
    upperBounds = [0   251   13]
  </ParticleSink>

  <ParticleSink upper0Absorber>
    kind = absorber
    minDim = 1
    lowerBounds = [250   -1   -1]
    upperBounds = [251   251   13]
  </ParticleSink>

  <ParticleSink lower1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   -1   -1]
    upperBounds = [250   0   13]
  </ParticleSink>

  <ParticleSink upper1Absorber>
    kind = absorber
    minDim = 2
    lowerBounds = [0   250   -1]
    upperBounds = [250   251   13]
  </ParticleSink>

</Species>

<Fluid neutralFluidAr>
  kind = neutralGas
  gasKind = Ar
  particleMass = 6.633520118604e-26
  charge = 0.
  temperature = 300.0
  ionizationEnergy = 15.76
  constantDensity = True

  <InitialCondition initialDensity>
    lowerBounds = [0  0  0]
    upperBounds = [251 251 0]
    components = [0]
    kind = varset

    <STFunc component0>
      kind = expression
      expression = 1.28527e+21
    </STFunc>

  </InitialCondition>

</Fluid>

<MonteCarloInteractions monteCarloInteractions>

  <IncidentSelector theselecter>
    kind = unbiasedSelector
  </IncidentSelector>

  <Interaction particleFluidImpactIonization0>
    kind = impactIonization
    impactSpecies = electrons
    ionizedElectronSpecies = electrons
    ionSpecies = Ions
    ionizationThreshold = 15.76
    isNeutralGasFluid = True
    neutralGas = neutralFluidAr
    neutralGasTemp = 300.0
    depleteBackgroundGas = False
    crossSection = functionDefined
    crossSectionVariable = energy

    <OAFunc crossSectionFunc>
      kind = expression
      expression = ((1.7155e-18*ln(0.0634*x)*((x-15.76)/sqr(x)))*(H(x-15.76)-H(x-79))+(2.648e-18*ln(0.0344*x)*((x-15.76)/sqr(x)))*(H(x-79)))
    </OAFunc>

  </Interaction>

  <Interaction impactElastic1>
    kind = impactElastic
    impactSpecies = electrons
    isNeutralGasFluid = True
    neutralGas = neutralFluidAr
    neutralGasTemp = 300.0
    depleteBackgroundGas = False
    crossSection = functionDefined
    crossSectionVariable = energy

    <OAFunc crossSectionFunc>
      kind = expression
      expression = ((H(x)-H(x-0.2))*10**(-(19+x/0.11))+(H(x-0.2))*(9.07*10**(-19)*x**1.55*(x+70)**1.1)/(14+x)**3.25)
    </OAFunc>

  </Interaction>

  <Interaction impactExcitation0>
    kind = impactExcitation
    impactSpecies = electrons
    excitationThreshold = 11.5
    isNeutralGasFluid = True
    neutralGas = neutralFluidAr
    neutralGasTemp = 300.0
    depleteBackgroundGas = False
    crossSection = functionDefined
    crossSectionVariable = energy

    <OAFunc crossSectionFunc>
      kind = expression
      expression = ((H(x-12))*(3.85116*1e-19*ln(x/3.4015)-4.85227*1e-19)/x)
    </OAFunc>

  </Interaction>

</MonteCarloInteractions>

<History electricFieldEnergy0>
  kind = fieldEnergy
  singleField = elecField
  fields = [esMultiField.nodalE]
</History>

<History numMacroPtcls0>
  kind = speciesNumberOf
  species = [electrons]
</History>

<History particleEnergy0>
  kind = speciesEnergy
  species = [electrons]
</History>

<History numMacroPtcls1>
  kind = speciesNumberOf
  species = [Ions]
</History>

<History particleEnergy1>
  kind = speciesEnergy
  species = [Ions]
</History>

<History numPhysPtcls0>
  kind = speciesNumPhysical
  species = [electrons]
</History>

<History numPhysPtcls1>
  kind = speciesNumPhysical
  species = [Ions]
</History>

<History particleMomentum0>
  kind = speciesMomen
  species = [electrons]
</History>

<History particleMomentum1>
  kind = speciesMomen
  species = [Ions]
</History>


